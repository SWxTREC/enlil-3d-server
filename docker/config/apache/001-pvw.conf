<VirtualHost *:80>
  DocumentRoot DOCUMENT-ROOT-DIRECTORY
  ErrorLog /var/log/apache2/001-pvw_error.log
  CustomLog /var/log/apache2/001-pvw_access.log combined
  Header add Access-Control-Allow-Origin "*"

  <Directory DOCUMENT-ROOT-DIRECTORY>
      Options Indexes FollowSymLinks
      Order allow,deny
      Allow from all
      AllowOverride None
      Require all granted
  </Directory>

  # APPLICATION-ENDPOINTS

  # Handle launcher forwarding
  ProxyPass /paraview https://localhost:9000/paraview
  # Handle websocket forwarding
  ProxyPass /proxy wss://localhost:9000/proxy
  # ProxyPass /enlil http://localhost:9000/enlil

  # # Main server
  # ProxyPass        / http://localhost:9000/
  # ProxyPassReverse / http://localhost:9000/

  # Handle WebSocket forwarding
  RewriteEngine On
  RewriteMap session-to-port txt:/opt/launcher/proxy-mapping.txt
  RewriteCond %{QUERY_STRING} ^sessionId=(.*)&path=(.*)$ [NC]
  RewriteRule ^/proxy.*$  wss://${session-to-port:%1}/%2  [P]
</VirtualHost>